# 实验七：防火墙和SSL实验

<center>姓名：张刘明  学号：2110049</center>

# 实验要求

1. 防火墙实验

防火墙实验在虚拟仿真环境下完成，要求如下：
（1）了解包过滤防火墙的基本配置方法、配置命令和配置过程。
（2）利用标准ACL，将防火墙配置为只允许某个网络中的主机访问另一个网络。
（3）利用扩展ACL，将防火墙配置为拒绝某个网络中的某台主机访问网络中的Web服务器。
（4）将防火墙配置为允许内网用户自由地向外网发起TCP连接，同时可以接收外网发回的TCP应答数据包。但是，不允许外网的用户主动向内网发起TCP连接。

2. SSL实验（选做）

SSL实验在实体环境下完成，要求如下：
（1）完成Web服务器的证书生成、证书审批、证书安装、证书允许等整个过程。
（2）实现浏览器与Web服务器的安全通信。

# 实验过程

路由器通常都带有⼀定的防⽕墙功能，在Cisco路由器中，可以使⽤访问控制列表ACL实现简单的数据报过滤。本次实验将会利⽤访问控制列表实现⼀个简单的数据包过滤防⽕墙。

## 防火墙实验

路由器通常都带有⼀定的防⽕墙功能，在Cisco路由器中，可以使⽤访问控制列表ACL实现简单的数据报过滤。本次实验将会利⽤访问控制列表实现⼀个简单的数据包过滤防⽕墙。

访问控制列表（ACL）是应⽤在⽹络设备接⼝上的规则列表，这些规则列表⽤于告诉⽹络设备哪些数据包可以通过，哪些数据包需要拒绝。ACL可应⽤于⽹络接⼝的⼊站⽅向（检查从该接⼝接收的所有数据包），或出站⽅向（检查从接⼝发出的所有数据包），⼀个ACL可以有多条规则，⽹络设备通常采⽤有限匹配原则，当出站的数据包到来的时候，⽹络设备按照次序依次对ACL列表中的规则进⾏匹配。⼀旦匹配成功，⽹络设备⽴即执⾏匹配规则中指定的动作，不再进⾏后续规则的匹配。

### 标准访问控制列表-标准ACL

- 利用IP数据包中的源IP地址对过往的数据包进行控制
- 列表号范围：1~99

#### 网络拓扑图

![Alt text](<image/屏幕截图 2023-12-11 145346.png>)

IP号已经在图上显⽰，实验的⽬标允许⽹络``202.113.26.0``中的主机访问⽹络``202.113.25.0``中的主机，但⽹络``202.113.27.0``中的主机不能访问⽹络A中的主机。

#### 设备配置

按照拓扑图给出的IP地址配置主机、路由器的IP地址，然后使⽤动态路由配置⽅法，配置路由器的路由表，可以直接在Config 窗⼝中配置，然后使⽤``no shutdown``激活各接⼝，使各⽹络中的主机能够相互访问。

router1-gig0/0:
![Alt text](<image/屏幕截图 2023-12-11 142636.png>)

router1-gig0/1:
![Alt text](<image/屏幕截图 2023-12-11 143018.png>)

router1-动态路由：
![Alt text](<image/屏幕截图 2023-12-11 151207.png>)

router2:
![Alt text](<image/屏幕截图 2023-12-11 143946.png>)

![Alt text](<image/屏幕截图 2023-12-11 151322.png>)

router3:
![Alt text](<image/屏幕截图 2023-12-11 144409.png>)

![Alt text](<image/屏幕截图 2023-12-11 151410.png>)

如图所⽰，此时各个网络中的主机都可以和⽹络``202.113.25.0``中的主机连通。

![Alt text](<image/屏幕截图 2023-12-11 151641.png>)

#### 配置ACK，允许⽹络``202.113.26.0``中的主机访问，但不允许其他⽹络中的主机访问

在Router1的全局配置模式下使⽤如下命令建⽴⼀个标号为6、包含两条规则的标准ACL：

``access-list 6 permit 202.113.26 0.0.0.255``
6是ACL的列表号，取值范围为1~99，相同列表号的规则属于同⼀个ACL，其先后顺序按照加⼊的先后顺序定，匹配成功后，⽹络设备采取的动作有两种，⼀种是permit（允许通过），另⼀种是deny（丢弃）， ``202.113.26`` 是源起始IP地址，后⾯``0.0.0.255``是通配符，从⽽允许⽹络``202.113.26.0``中的主机发送的数据报通过，⽤于定义IP地址的范围

``access-list 6 deny any``(该语句事实上可以省略)
any表⽰任意的主机进⼊gig0/1接⼝配置模式，利⽤``ip access-group 6 in``将6号ACL绑定在gig0/1的⼊站上。

![Alt text](<image/屏幕截图 2023-12-11 152344.png>)

#### 测试验证

利⽤⽹络``202.113.26.0``中的主机ping⽹络``202.113.25.0``中的主机，可以ping通：

![Alt text](<image/屏幕截图 2023-12-11 152700.png>)

利⽤⽹络``202.113.27.0``中的主机ping⽹络``202.113.25.0``中的主机，发现Router1阻⽌了它：

![Alt text](<image/屏幕截图 2023-12-11 152828.png>)





### 扩展访问控制列表-扩展ACL

- 按照协议类型、源IP地址、目的IP地址、源端口号、目的端口号对过往的数据包进行控制
- 列表号范围：101~199

#### 网络拓扑图

![Alt text](<image/屏幕截图 2023-12-11 153502.png>)

#### 设备配置

按照如上拓扑图给出的IP地址配置主机、路由器的IP地址，然后配置路由器的路由表，可以直接在Config 窗⼝中配置，然后使⽤``no shutdown``激活各接⼝，使各网络的主机能够相互访问，这里就不再插入截图。

打开⽹络``202.113.25.0``中的服务器的HTTP服务，利⽤⽹络``202.113.26.0``和⽹络``202.113.27.0``主机的Web Browser浏览WebServer服务器上的⽹⻚，配置成功。

#### 配置扩展ACK，允许除PC4外其他主机浏览WebServer服务器的Web界⾯。

添加扩展ACL规则的⼀般命令形式为：
``Access-list ListNum {permit|deny} Protocol SrcIPAddr SrcPort DesIPAddr DesPort``
其中``ListNum``是``ACL``号，取值范围是``101~199``;``{permit|deny}``表⽰匹配成功后，⽹络设备采取的动
作；``permit``为允许通过，``deny``是丢弃；``Protocol``指定该条规则适⽤的协议类型，协议类型可以是``ip,icmp,tcp,udp``。``SrcPAddr``指定源IP地址范围。``SrcPort``指定源TCP或者是UDP端⼝范围。
在Router1的全局配置模式下使⽤如下命令建⽴⼀个标号为106、包含两条规则的扩展ACL：
```cli
access-list 106 deny tcp host 202.113.26.2 host 202.113.25.3 eq www
# www等价于80

access-list 106 permit ip any any
```
绑定ACL⾄端⼝：进⼊``gig0/1``接⼝配置模式，利⽤``ip access-group 106 in``将106号ACL绑定在``gig0/1``的⼊站上。

![Alt text](<image/屏幕截图 2023-12-11 154712.png>)


#### 测试验证

网络``202.113.26.0``下的PC3访问成功：
![Alt text](<image/屏幕截图 2023-12-11 154825.png>)

网络``202.113.27.0``下的PC5访问成功：
![Alt text](<image/屏幕截图 2023-12-11 154910.png>)

网络``202.113.26.0``下的PC4访问失败：
![Alt text](<image/屏幕截图 2023-12-11 154956.png>)


### SSL实验













